<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SGPA Calculator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #121212;
            color: #e0e0e0;
            padding: 20px;
        }

        .container {
            background-color: #1f1f1f;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }

        h1, .card-title {
            color: #bb86fc;
        }
        
        .form-control {
            background-color: #2c2c2c;
            color: #e0e0e0;
            border: 1px solid #3d3d3d;
        }
        .form-control:focus {
            background-color: #2c2c2c;
            color: #e0e0e0;
            border-color: #bb86fc;
            box-shadow: 0 0 0 0.25rem rgba(187, 134, 252, 0.25);
        }
        .input-group-text {
            background-color: #3d3d3d;
            color: #e0e0e0;
            border: 1px solid #3d3d3d;
        }

        @media (min-width: 992px) {
            .form-scroll-area {
                max-height: 500px;
                overflow-y: auto;
                padding-right: 15px;
            }
        }
        
        #visualization {
            background-color: #2c2c2c; 
            border: 1px solid #3d3d3d;
            border-radius: 0.25rem;
            height: 350px;
            position: relative;
            overflow: hidden;
        }

        .line-chart-svg {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }

        .data-point-marker {
            fill: #03dac6;
            stroke: #03dac6;
            stroke-width: 2;
            transition: cy 0.5s ease-out;
        }

        .data-line {
            fill: none;
            stroke: #03dac6;
            stroke-width: 2;
            transition: d 0.5s ease-out;
        }

        .point-value-label {
            fill: #bb86fc;
            font-size: 0.75rem;
            font-weight: bold;
            text-anchor: middle;
            transition: y 0.5s ease-out;
        }

        .semester-label {
            fill: #e0e0e0;
            font-size: 0.7rem;
            text-anchor: middle;
        }

        .average-line {
            position: absolute;
            left: 0;
            right: 0;
            border-bottom: 2px dashed #cf6679;
            transition: bottom 0.5s ease-out;
            pointer-events: none;
            z-index: 10;
        }
        .average-label {
            position: absolute;
            right: 8px;
            left: auto;
            top: 6px;
            font-size: 0.8rem;
            color: #cf6679;
            background: #2c2c2c;
            padding: 0 6px;
            z-index: 11;
            border-radius: 3px;
        }
    </style>
</head>
<body>

    <div class="container py-4">
        <h1 class="text-center mb-4">SGPA Average Calculator & Visualizer</h1>
        <h2 class="text-center mb-4">find out how much you gotta score in your next semester :D</h2>
        
        <div class="row">
            
            <div class="col-lg-6 mb-4">
                <div class="card bg-dark text-white p-4">
                    <h5 class="card-title text-center">SGPA Data Entry</h5>
                    <div class="form-scroll-area">
                        <form id="sgpa-form">
                            </form>
                    </div>
                    
                    <div class="mt-4 pt-3 border-top border-secondary">
                        <h5 class="text-center text-success">Calculated Average</h5>
                        <p class="text-center mb-0">Semesters Counted: <span id="count-result" class="fw-bold text-info">0</span></p>
                        <p class="text-center fs-2 fw-bold" id="average-result">0.00</p>
                    </div>
                </div>
            </div>

            <div class="col-lg-6">
                <div class="card bg-dark text-white p-4">
                    <h5 class="card-title text-center">SGPA Trend Chart</h5>
                    <div id="visualization">
                        </div>
                </div>
            </div>

        </div>

        <div class="row mt-4">
            <div class="col-12">
                <div class="card bg-dark text-white p-4">
                    <h5 class="card-title text-center">SPPU 2019 Converters</h5>

                    <ul class="nav nav-tabs mt-3" id="convTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="sgpa-tab" data-bs-toggle="tab" data-bs-target="#sgpa-pane" type="button" role="tab">SGPA</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="cgpa-tab" data-bs-toggle="tab" data-bs-target="#cgpa-pane" type="button" role="tab">CGPA</button>
                        </li>
                    </ul>

                    <div class="tab-content p-3" id="convTabsContent">
                        <div class="tab-pane fade show active" id="sgpa-pane" role="tabpanel">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">SGPA</label>
                                    <input id="sgpa-input-live" type="number" min="0" max="10" step="0.01" class="form-control" placeholder="Enter SGPA">
                                </div>
                                <div class="col-md-6 align-self-end">
                                    <p class="mb-0">Status: <span id="sgpa-status" class="fw-bold text-info">-</span></p>
                                </div>
                                <div class="col-12 mt-2">
                                    <p>Percent from SGPA: <span id="sgpa-percent" class="fw-bold text-info">-</span></p>
                                </div>
                            </div>
                        </div>

                        <div class="tab-pane fade" id="cgpa-pane" role="tabpanel">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">CGPA</label>
                                    <input id="cgpa-input-live" type="number" min="0" max="10" step="0.01" class="form-control" placeholder="Enter CGPA">
                                </div>
                                <div class="col-md-6 align-self-end">
                                    <p class="mb-0">Inferred Grade: <span id="cgpa-grade" class="fw-bold text-info">-</span></p>
                                    <p class="mb-0">Degree Class: <span id="cgpa-class" class="fw-bold text-info">-</span></p>
                                </div>
                                <div class="col-12 mt-2">
                                    <p>Percent from CGPA: <span id="cgpa-percent" class="fw-bold text-info">-</span></p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

    </div>

    <footer class="text-center mt-3 text-muted">made by nishtha</footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const numSemesters = 8;
            const form = document.getElementById('sgpa-form');
            const inputsContainer = form;
            const averageResult = document.getElementById('average-result');
            const countResult = document.getElementById('count-result');
            const visualizationArea = document.getElementById('visualization');
            const visualizationHeight = 350;
            const visualizationWidth = visualizationArea.offsetWidth || 400; 
            const padding = { top: 30, right: 20, bottom: 40, left: 20 };
            const chartHeight = visualizationHeight - padding.top - padding.bottom;
            const chartWidth = visualizationWidth - padding.left - padding.right;

            function createInputs() {
                for (let i = 1; i <= numSemesters; i++) {
                    const group = document.createElement('div');
                    group.className = 'input-group mb-3';
                    
                    const span = document.createElement('span');
                    span.className = 'input-group-text';
                    span.textContent = `Sem ${i}`;
                    
                    const input = document.createElement('input');
                    input.setAttribute('type', 'number');
                    input.className = 'form-control';
                    input.setAttribute('id', `sgpa-sem-${i}`);
                    input.setAttribute('min', '0');
                    input.setAttribute('max', '10');
                    input.setAttribute('step', '0.01');
                    input.setAttribute('placeholder', '0.00 to 10.00');
                    
                    input.addEventListener('input', updateUI);
                    
                    group.appendChild(span);
                    group.appendChild(input);
                    inputsContainer.appendChild(group);
                }
            }

            function updateUI() {
                let totalSGPA = 0;
                let validDataPoints = [];
                let validCount = 0;
                
                const inputs = inputsContainer.querySelectorAll('input[type="number"]');

                inputs.forEach((input, index) => {
                    let value = parseFloat(input.value);
                    
                    if (!isNaN(value) && value >= 0 && value <= 10) {
                        totalSGPA += value;
                        validCount++;
                        validDataPoints.push({ semester: index + 1, value: value });
                    }
                });

                let average = 0;
                if (validCount > 0) {
                    average = totalSGPA / validCount;
                }

                averageResult.textContent = average.toFixed(2);
                countResult.textContent = validCount;

                renderVisualization(validDataPoints, average);
            }

            function renderVisualization(dataPoints, average) {
                visualizationArea.innerHTML = ''; 

                const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
                svg.setAttribute('class', 'line-chart-svg');
                svg.setAttribute('viewBox', `0 0 ${visualizationWidth} ${visualizationHeight}`);
                svg.setAttribute('preserveAspectRatio', 'xMidYMid meet');
                visualizationArea.appendChild(svg);

                if (dataPoints.length === 0) {
                    return;
                }

                const xScale = (semester) => padding.left + (semester - 1) * (chartWidth / (numSemesters - 1));
                const yScale = (sgpa) => visualizationHeight - padding.bottom - (sgpa / 10) * chartHeight;

                let pathData = '';
                dataPoints.forEach((point, index) => {
                    const x = xScale(point.semester);
                    const y = yScale(point.value);

                    if (index === 0) {
                        pathData += `M ${x} ${y}`;
                    } else {
                        pathData += ` L ${x} ${y}`;
                    }

                    const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                    circle.setAttribute('class', 'data-point-marker');
                    circle.setAttribute('cx', x);
                    circle.setAttribute('cy', y);
                    circle.setAttribute('r', 4);
                    svg.appendChild(circle);

                    const textValue = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    textValue.setAttribute('class', 'point-value-label');
                    textValue.setAttribute('x', x);
                    textValue.setAttribute('y', y - 10);
                    textValue.textContent = point.value.toFixed(2);
                    svg.appendChild(textValue);
                });

                if (pathData) {
                    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    path.setAttribute('class', 'data-line');
                    path.setAttribute('d', pathData);
                    svg.appendChild(path);
                }

                for (let i = 1; i <= numSemesters; i++) {
                    const x = xScale(i);
                    const textSem = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    textSem.setAttribute('class', 'semester-label');
                    textSem.setAttribute('x', x);
                    textSem.setAttribute('y', visualizationHeight - 10);
                    textSem.textContent = `Sem ${i}`;
                    svg.appendChild(textSem);
                }

                if (average > 0) {
                    const averageLine = document.createElement('div');
                    averageLine.className = 'average-line';
                    
                    const averageHeightPixels = (average / 10) * chartHeight;
                    averageLine.style.bottom = `${averageHeightPixels + padding.bottom}px`;

                    const averageLabel = document.createElement('span');
                    averageLabel.className = 'average-label';
                    averageLabel.textContent = `AVG: ${average.toFixed(2)}`;
                    averageLine.appendChild(averageLabel);

                    visualizationArea.appendChild(averageLine);
                }
            }

            createInputs();
            updateUI(); 

            const cgpaInputLive = document.getElementById('cgpa-input-live');
            const cgpaPercentEl = document.getElementById('cgpa-percent');
            const cgpaGradeEl = document.getElementById('cgpa-grade');
            const cgpaClassEl = document.getElementById('cgpa-class');

            const sgpaInputLive = document.getElementById('sgpa-input-live');
            const sgpaPercentEl = document.getElementById('sgpa-percent');
            const sgpaStatusEl = document.getElementById('sgpa-status');

            function inferGradeAndClass(cgpa) {
                if (isNaN(cgpa)) return { grade: '-', klass: '-' };
                if (cgpa > 8.25) return { grade: 'A+', klass: 'First Class with Distinction' };
                if (cgpa > 6.75) return { grade: 'A', klass: 'First Class' };
                if (cgpa > 5.75) return { grade: 'B+', klass: 'Second Class' };
                if (cgpa > 5.25) return { grade: 'B', klass: 'Second Class' };
                if (cgpa > 4.75) return { grade: 'C', klass: 'Pass Class' };
                return { grade: 'Fail', klass: 'Fail' };
            }

            function percentFromCgpaByGrade(cgpa, grade) {
                if (isNaN(cgpa)) return NaN;
                switch (grade) {
                    case 'A+': return 12 * cgpa - 25;
                    case 'A': return 10 * cgpa - 7.5;
                    case 'B+': return 5 * cgpa + 26.25;
                    case 'B': return 10 * cgpa - 2.5;
                    case 'C': return 10 * cgpa - 2.5;
                    case 'Fail': return 20 * cgpa - 100;
                    default: return NaN;
                }
            }

            function updateCgpaLive() {
                const cgpa = parseFloat(cgpaInputLive.value);
                const info = inferGradeAndClass(cgpa);
                cgpaGradeEl.textContent = info.grade;
                cgpaClassEl.textContent = info.klass;
                const pct = percentFromCgpaByGrade(cgpa, info.grade);
                cgpaPercentEl.textContent = isFinite(pct) ? pct.toFixed(2) + ' %' : '-';
            }

            function percentFromSgpa(sgpa) {
                if (isNaN(sgpa)) return NaN;
                return (sgpa * 10) - 7.5;
            }

            function updateSgpaLive() {
                const sgpa = parseFloat(sgpaInputLive.value);
                const pct = percentFromSgpa(sgpa);
                sgpaPercentEl.textContent = isFinite(pct) ? pct.toFixed(2) + ' %' : '-';
                if (isNaN(sgpa)) {
                    sgpaStatusEl.textContent = '-';
                } else {
                    sgpaStatusEl.textContent = sgpa > 4.75 ? 'Pass' : 'Fail';
                }
            }

            if (cgpaInputLive) cgpaInputLive.addEventListener('input', updateCgpaLive);
            if (sgpaInputLive) sgpaInputLive.addEventListener('input', updateSgpaLive);

            window.addEventListener('resize', () => {
                updateUI();
            });
        });
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>